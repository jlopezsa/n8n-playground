{"updatedAt":"2026-01-17T16:07:57.788Z","createdAt":"2025-12-04T20:11:48.625Z","id":"BOYmpmJ3NFd63QYJ","name":"respaldar workflows en gitlab","active":false,"isArchived":false,"nodes":[{"parameters":{"rule":{"interval":[{}]}},"type":"n8n-nodes-base.scheduleTrigger","typeVersion":1.2,"position":[144,-80],"id":"91f6413a-73a9-4486-bc1c-4c6c151eb157","name":"Schedule Trigger"},{"parameters":{"assignments":{"assignments":[{"id":"61d1ea47-c792-4aeb-bb5a-adc8664483c9","name":"RepositoryOwner","value":"Julian.Lopez","type":"string"},{"id":"ae34eb26-b017-422d-802b-38f0e5090895","name":"RepositoryName","value":"n8n-playground","type":"string"}]},"options":{}},"type":"n8n-nodes-base.set","typeVersion":3.4,"position":[352,-80],"id":"a45ebeeb-2675-4810-b4b5-790fb7dc158d","name":"Edit Fields"},{"parameters":{"resource":"file","operation":"list","owner":"Julian.Lopez","repository":"n8n-playground","additionalParameters":{}},"type":"n8n-nodes-base.gitlab","typeVersion":1,"position":[560,-80],"id":"a7946816-c097-4e0f-9a0b-c183c19b3428","name":"List files"},{"parameters":{"fieldsToAggregate":{"fieldToAggregate":[{}]},"options":{}},"type":"n8n-nodes-base.aggregate","typeVersion":1,"position":[768,-80],"id":"5c8077dd-619b-4f47-848a-17d1d692078a","name":"Aggregate"},{"parameters":{"filters":{},"requestOptions":{}},"type":"n8n-nodes-base.n8n","typeVersion":1,"position":[976,-80],"id":"85c83bab-fc14-4e53-b96f-d4fc12bfdb12","name":"Get many workflows"},{"parameters":{"operation":"toBinary","options":{}},"type":"n8n-nodes-base.convertToFile","typeVersion":1.1,"position":[1184,-80],"id":"ba4bcfaa-b61e-45c7-98a1-aa15a0fad0ab","name":"Convert to File"},{"parameters":{"filters":{},"requestOptions":{}},"id":"d227e825-3474-47ea-8d4e-2b50cf1e9afd","name":"Captura de Workflows","type":"n8n-nodes-base.n8n","typeVersion":1,"position":[3472,128],"alwaysOutputData":false,"retryOnFail":true,"executeOnce":false,"maxTries":5},{"parameters":{"options":{}},"type":"n8n-nodes-base.splitInBatches","typeVersion":3,"position":[3920,128],"id":"27cfaef8-5406-4bb3-b87e-67151559c8ed","name":"Loop Over Items"},{"parameters":{},"type":"n8n-nodes-base.noOp","typeVersion":1,"position":[4160,48],"id":"986bc3d5-8ccc-4d48-ad57-c0137efc75c1","name":"No Operation, do nothing"},{"parameters":{"rule":{"interval":[{}]}},"type":"n8n-nodes-base.scheduleTrigger","typeVersion":1.2,"position":[2576,128],"id":"ef0697e2-555b-4521-ad19-8054f49b0450","name":"Nodo Programado"},{"parameters":{"assignments":{"assignments":[{"id":"a1d52ea6-5912-4988-94c2-115ad59c1996","name":"Repository Owner","value":"Julian.Lopez","type":"string"},{"id":"1c15b2e1-bf09-4643-8bba-3215119d2d6b","name":"Repository Name","value":"n8n-playground","type":"string"},{"id":"712f49ff-8f02-4ac3-aee8-11db8ebe5843","name":"commitDate","value":"={{ (() => {\n  const now = new Date();\n  const day = String(now.getDate()).padStart(2, '0');\n  const month = String(now.getMonth() + 1).padStart(2, '0');\n  const year = now.getFullYear();\n  const hours = String(now.getHours()).padStart(2, '0');\n  const minutes = String(now.getMinutes()).padStart(2, '0');\n  return `${day}-${month}-${year}/${hours}:${minutes}`;\n})() }}","type":"string"}]},"options":{}},"type":"n8n-nodes-base.set","typeVersion":3.4,"position":[2800,128],"id":"149585d0-9956-4f64-a14d-8ac71918674d","name":"Establecer campos"},{"parameters":{"mode":"jsonToBinary","options":{"fileName":"={{ $json.name.replace(/\\s+/g, '-').toLowerCase() }}-{{ $json.id }}.json"}},"id":"a0ca1b36-0b85-4061-a403-b335e3ff7987","name":"Convertir a binario","type":"n8n-nodes-base.moveBinaryData","typeVersion":1,"position":[3696,128]},{"parameters":{"conditions":{"string":[{"value1":"={{ $node['Combinar archivos'].json.name }}","operation":"contains","value2":"={{ $binary.data.fileName }}"}]}},"id":"0689c73c-c2a3-48f7-9c43-e28c346d6852","name":"Si existe","type":"n8n-nodes-base.if","typeVersion":1,"position":[4160,224]},{"parameters":{"content":"## ðŸ›¡ï¸ Workflow de Respaldo AutomÃ¡tico de Workflows en N8N\n\nEste workflow se ejecuta **diariamente a las 12:00 a.m.** y respalda todos los workflows de N8N en un repositorio de GitLab.\n\n---\n\n### âš™ï¸ ConfiguraciÃ³n Inicial\n\n* **Repository Owner**: tu usuario de GitHub\n* **Repository Name**: nombre del repositorio\n* **Commit Date**: fecha y hora actual (`DD-MM-YYYY/HH:SS`)\n\n---\n\n### ðŸ” AutenticaciÃ³n\n\n**GitHub:**\n\n1. Crea un repositorio en GitHub.\n2. Ve a `Settings > Developer Settings > Tokens (classic)`.\n3. Genera un token con permisos (`write-packages`).\n4. Usa el token en las credenciales de GitHub en N8N.\n\n**N8N:**\n\n1. Ve a `Settings > API` en tu instancia.\n2. Genera un token.\n3. Usa como Base URL:\n\n   ```\n   https://TU_INSTANCIA.com/api/v1\n   ```\n---\n\n### ðŸ”„ Flujo del Proceso\n\n1. Se listan los archivos actuales del repositorio (GitHub).\n2. Se obtienen todos los workflows desde N8N (JSON).\n3. Se convierten a binario.\n4. En un loop:\n\n   * Si el archivo existe â†’ se actualiza.\n   * Si no existe â†’ se sube como nuevo.\n\n---\n\n### âœ… Resultado\n\nTodos los workflows quedan respaldados en GitHub con un commit que incluye la fecha y hora.\n\n\n\n","height":1168,"width":928,"color":5},"type":"n8n-nodes-base.stickyNote","typeVersion":1,"position":[1552,-528],"id":"288f57af-0a6b-4e8a-b4bd-9a73a228c16b","name":"Sticky Note1"},{"parameters":{"fieldsToAggregate":{"fieldToAggregate":[{"fieldToAggregate":"name"}]},"options":{}},"type":"n8n-nodes-base.aggregate","typeVersion":1,"position":[3248,128],"id":"ca34982a-45a1-43f5-bcae-18e9a6aaa0c7","name":"Combinar archivos"},{"parameters":{"resource":"file","operation":"edit","owner":"={{ $('Establecer campos').item.json['Repository Owner'] }}","repository":"={{ $('Establecer campos').item.json['Repository Name'] }}","filePath":"={{ $binary.data.fileName }}","binaryData":true,"commitMessage":"={{ $('Establecer campos').item.json.commitDate }}","branch":"dev"},"type":"n8n-nodes-base.gitlab","typeVersion":1,"position":[4400,208],"id":"8bc429ee-13c0-4bd6-9f98-df958791a6ee","name":"Edit a file"},{"parameters":{"resource":"file","owner":"={{ $('Establecer campos').item.json['Repository Owner'] }}","repository":"={{ $('Establecer campos').item.json['Repository Name'] }}","filePath":"={{ $binary.data.fileName }}","binaryData":true,"commitMessage":"={{ $('Establecer campos').item.json.commitDate }}","branch":"dev"},"type":"n8n-nodes-base.gitlab","typeVersion":1,"position":[4400,432],"id":"159995d5-6a78-433d-8e15-dc8c9e52b557","name":"Create a file"},{"parameters":{"url":"http://localhost:5678/api/v1/workflows?active=true","sendHeaders":true,"headerParameters":{"parameters":[{"name":"X-N8N-API-KEY","value":"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJjZWY0Y2FiMy1jOTc5LTRiYjItYjhhMC1kZTgwNGRmZTVlYzgiLCJpc3MiOiJuOG4iLCJhdWQiOiJwdWJsaWMtYXBpIiwiaWF0IjoxNzYxNzY1MzE5LCJleHAiOjE3Njk0OTAwMDB9.5NONpZ-i1TpuNtB3yxonYHR7-7lVk0DFtpGruxZwN00"}]},"options":{"lowercaseHeaders":false}},"type":"n8n-nodes-base.httpRequest","typeVersion":4.3,"position":[2800,336],"id":"27eb9d36-f0e9-4f23-891a-5743dad1df2c","name":"HTTP Request"},{"parameters":{"resource":"file","operation":"list","owner":"={{ $json[\"Repository Owner\"] }}","repository":"={{ $json['Repository Name'] }}","returnAll":true,"additionalParameters":{"ref":"dev"}},"type":"n8n-nodes-base.gitlab","typeVersion":1,"position":[3024,128],"id":"ed55f9e2-7ebc-4afb-902f-800c9ecab757","name":"List files1","alwaysOutputData":true}],"connections":{"Schedule Trigger":{"main":[[{"node":"Edit Fields","type":"main","index":0}]]},"Edit Fields":{"main":[[{"node":"List files","type":"main","index":0}]]},"List files":{"main":[[{"node":"Aggregate","type":"main","index":0}]]},"Aggregate":{"main":[[{"node":"Get many workflows","type":"main","index":0}]]},"Get many workflows":{"main":[[{"node":"Convert to File","type":"main","index":0}]]},"Captura de Workflows":{"main":[[{"node":"Convertir a binario","type":"main","index":0}]]},"Loop Over Items":{"main":[[{"node":"No Operation, do nothing","type":"main","index":0}],[{"node":"Si existe","type":"main","index":0}]]},"Nodo Programado":{"main":[[{"node":"Establecer campos","type":"main","index":0}]]},"Establecer campos":{"main":[[{"node":"List files1","type":"main","index":0}]]},"Convertir a binario":{"main":[[{"node":"Loop Over Items","type":"main","index":0}]]},"Si existe":{"main":[[{"node":"Edit a file","type":"main","index":0}],[{"node":"Create a file","type":"main","index":0}]]},"Combinar archivos":{"main":[[{"node":"Captura de Workflows","type":"main","index":0}]]},"Edit a file":{"main":[[{"node":"Loop Over Items","type":"main","index":0}]]},"Create a file":{"main":[[{"node":"Loop Over Items","type":"main","index":0}]]},"List files1":{"main":[[{"node":"Combinar archivos","type":"main","index":0}]]}},"settings":{"executionOrder":"v1"},"staticData":{"node:Schedule Trigger":{"recurrenceRules":[]},"node:Nodo Programado":{"recurrenceRules":[]}},"meta":null,"pinData":{},"versionId":"7be41e72-5e3e-445a-be57-9b0fe39d4059","activeVersionId":null,"triggerCount":2,"shared":[{"updatedAt":"2025-12-04T20:11:48.625Z","createdAt":"2025-12-04T20:11:48.625Z","role":"workflow:owner","workflowId":"BOYmpmJ3NFd63QYJ","projectId":"0Dd2bpafaqMtoS2H"}],"activeVersion":null,"tags":[]}